(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{111:function(e,t,n){e.exports={logo:"App_logo__30VG7","App-logo-spin":"App_App-logo-spin__qJ1EI",logoBG:"App_logoBG__2thSm",app:"App_app__1XhhN"}},112:function(e,t,n){e.exports=n.p+"static/media/map-01-med-cropped.eb12cece.png"},115:function(e,t,n){e.exports={cameraDiv:"Camera_cameraDiv__Kglyi"}},120:function(e,t,n){e.exports=n.p+"static/media/class_coords.05c81209.csv"},125:function(e,t,n){e.exports=n(289)},130:function(e,t,n){},132:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},133:function(e,t,n){},135:function(e,t,n){},139:function(e,t,n){},141:function(e,t,n){var a={"./arrow.svg":142,"./grapes.svg":143,"./location-blue.svg":144,"./location-green.svg":145,"./location-red.svg":146,"./tomato.svg":147};function r(e){var t=o(e);return n(t)}function o(e){var t=a[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}r.keys=function(){return Object.keys(a)},r.resolve=o,e.exports=r,r.id=141},142:function(e,t,n){e.exports=n.p+"static/media/arrow.7f41c8e0.svg"},143:function(e,t,n){e.exports=n.p+"static/media/grapes.11be6a40.svg"},144:function(e,t,n){e.exports=n.p+"static/media/location-blue.42d5da8a.svg"},145:function(e,t,n){e.exports=n.p+"static/media/location-green.fc82852f.svg"},146:function(e,t,n){e.exports=n.p+"static/media/location-red.6c8c363d.svg"},147:function(e,t,n){e.exports=n.p+"static/media/tomato.ba199f9c.svg"},164:function(e,t){},166:function(e,t){},199:function(e,t){},200:function(e,t){},24:function(e,t,n){e.exports={main:"UI_main__XVD77",buttonDiv:"UI_buttonDiv__3FU_B",carouselDiv:"UI_carouselDiv__2XtUN",discoverDiv:"UI_discoverDiv__2xFvL"}},246:function(e,t){},247:function(e,t){},248:function(e,t){},28:function(e,t,n){e.exports={buttonDiv:"Button_buttonDiv__994C-",button:"Button_button__xwqJU",buttonLeft:"Button_buttonLeft__2lenD Button_button__xwqJU",buttonRight:"Button_buttonRight__14hzO Button_button__xwqJU"}},288:function(e){e.exports={}},289:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(27),c=n.n(o),i=(n(130),n(5)),u=(n(132),n(133),n(135),n(111)),s=n.n(u),l=n(66),f=n.n(l),p=n(122),m=n(291),d=n(294),v=n(293),h=n(292),b=n(9),g=n.n(b),E=(n(139),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tomato",t=arguments.length>1?arguments[1]:void 0,a={iconAnchor:[],popupAnchor:[]},r="arrow"===e;return"tomato"===e||"grapes"===e?(a.iconAnchor=[0,t],a.popupAnchor=[.5*t,-t]):r?(a.iconAnchor=[t,t],a.popupAnchor=[-.5*t,-t]):(a.iconAnchor=[.5*t,t],a.popupAnchor=[0,-t]),new g.a.Icon({iconUrl:n(141)("./".concat(e,".svg")),iconSize:[t,t],iconAnchor:a.iconAnchor,popupAnchor:a.popupAnchor})}),O=n(112),j=n.n(O),_=[[0,0],[2500,2738]];delete g.a.Icon.Default.prototype._getIconUrl,g.a.Icon.Default.mergeOptions({iconRetinaUrl:n(148),iconUrl:n(149),shadowUrl:n(150)});var w=function(e){var t=e.points,n=e.labels,a=e.icons,o=e.alwaysOpenPopup,c=function(e){e&&e.leafletElement&&o&&window.setTimeout(function(){e.leafletElement.openPopup()})};if(!t||0===t.length)return null;if(2!==t[0].length)throw"points are not in an array of [lat, lng], cannot create Marker!";var i=n||Object(p.a)(Array(t.length)).map(function(){return"label"});return a?t.map(function(e,t){return r.a.createElement(m.a,{key:t,position:e,icon:a[t],ref:c},r.a.createElement(d.a,null,i[t]))}):t.map(function(e,t){return r.a.createElement(m.a,{key:t,position:e,ref:c},r.a.createElement(d.a,null,i[t]))})},x=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,a=function(e,t){var n=t.map(function(t,n){return{index:n,value:Array.isArray(e)?Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)):Math.sqrt(Math.pow(e.lat-t.lat,2)+Math.pow(e.lng-t.lng,2))}});return n.sort(function(e,t){return e.value>t.value?1:e.value===t.value?0:-1}),n.map(function(e){return e.index})}(e,t.dataset.map(function(e){return[e.x,e.y]})).slice(0,n),r=t.dataset.filter(function(e,t){return a.filter(function(e){return e===t}).length>0});return{pins:r.map(function(e){return[e.x,e.y]}),lbls:r.map(function(e){return e.label})}},y=function(e){var t,n=e.height,o=Object(a.useContext)(ge),c=o.point,i=o.setPoint,u=o.setClosestList,s=x(c,o,5),l=s.pins,f=s.lbls;Object(a.useEffect)(function(){u({pins:l,lbls:f})},[]);var p=o.search;Object(a.useEffect)(function(){""!==p&&function(){console.log(p);var e=function(e,t){var n=t.dataset.filter(function(t){return t.label===e})[0];return{lat:n.x,lng:n.y}}(p,o),n=e.lat,a=e.lng;i([n,a]),t=x([n,a],o,5),u(t)}()},[p]);var m=_;return r.a.createElement(v.a,{center:c,zoom:1,minZoom:-2,maxZoom:2,style:{height:n||300,width:"100%"},onClick:function(e){i([e.latlng.lat,e.latlng.lng]),t=x([e.latlng.lat,e.latlng.lng],o,5),u(t)},crs:g.a.CRS.Simple},r.a.createElement(h.a,{alt:"local map",url:j.a,bounds:m}),r.a.createElement(w,{points:[c],labels:["".concat(Math.round(c[0])," ").concat(Math.round(c[1]))],icons:[E("arrow",40)],alwaysOpenPopup:!0}),r.a.createElement(w,{points:l,labels:f}))},S=function(e){e.data;var t=e.children;return r.a.createElement("div",{className:f.a.main},r.a.createElement("div",{className:f.a.map},r.a.createElement(y,{height:"100%"})),r.a.createElement("div",{style:{zIndex:2,pointerEvents:"none"}},t))},k=n(24),C=n.n(k),D=n(51),N=n.n(D),A=function(e){var t=e.text,n=e.onExit,o=e.blurOnButtonOnly,c=e.hideExitButton,i=e.children,u=Object(a.useRef)(null),s=function(e){e.currentTarget&&"BUTTON"===e.currentTarget.tagName&&n(),e.relatedTarget&&("leaflet-container"!==e.relatedTarget.className.split(" ")[0]||o||n())};return Object(a.useEffect)(function(){u.current.focus()},[]),r.a.createElement("div",{ref:u,className:N.a.card,tabIndex:"-1",onBlur:s},c?null:r.a.createElement("div",{className:N.a.buttonDiv},r.a.createElement("button",{className:N.a.exitButton,onClick:s},"X")),t,i)},I=n(10),T=n.n(I),U=n(18),L=n(114),B=n.n(L),P=n(115),M=n.n(P),F=void 0,R=function(e){var t=e.onRef,n=Object(a.useRef)(),o=Object(a.useState)(!1),c=Object(i.a)(o,2),u=c[0],s=c[1],l=function(){var e=Object(U.a)(T.a.mark(function e(){var t;return T.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){e.next=4;break}throw t="Browser API navigator.mediaDevices.getUserMedia not available",F.setState({error_messages:t}),t;case 4:n.current.video.onloadedmetadata=function(){s(!0)};case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)(function(){l(),u&&t&&t(n)},[n,t,u]),r.a.createElement("div",{className:M.a.cameraDiv},r.a.createElement(B.a,{audio:!1,ref:n,screenshotFormat:"image/jpeg"}))},X=n(22),q=n(121),J=n(35),H=n.n(J),V=n(37),W=n(36),Y=n.n(W),z=function(e){return"https://en.wikipedia.org/w/api.php?action=opensearch&origin=*&search=".concat(e,"&format=json")},G=function(e,t){switch(t.type){case"FETCH_INIT":return Object(V.a)({},e,{isLoading:!0,error:""});case"FETCH_SUCCESS":return Object(V.a)({},e,{isLoading:!1,data:t.payload});case"FETCH_FAILURE":return Object(V.a)({},e,{isLoading:!1,error:t.payload});default:throw new Error("dunno what to do with this condition")}},Z=function(e){var t=e.search,n=Object(a.useState)("redux"),o=Object(i.a)(n,2),c=(o[0],o[1],function(e,t){var n=Object(a.useState)(t||{hits:[]}),r=Object(i.a)(n,2),o=(r[0],r[1],Object(a.useState)(e||"http://hn.algolia.com/api/v1/search?query=redux")),c=Object(i.a)(o,2),u=c[0],s=c[1],l=Object(a.useReducer)(G,{isLoading:!1,error:"",data:t}),f=Object(i.a)(l,2),p=f[0],m=f[1];return Object(a.useEffect)(function(){var e=!1;return function(){var t=Object(U.a)(T.a.mark(function t(){var n;return T.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return m({type:"FETCH_INIT"}),t.prev=1,t.next=4,H()(u);case 4:n=t.sent,e||m({type:"FETCH_SUCCESS",payload:n.data}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),e||m({type:"FETCH_FAILURE",payload:t.t0.message});case 11:case"end":return t.stop()}},t,this,[[1,8]])}));return function(){return t.apply(this,arguments)}}()(),function(){e=!0}},[u]),Object(V.a)({},p,{doFetch:function(e){s(e)}})}("https://hn.algolia.com/api/v1/search?query=redux",{hits:[]})),u=c.data,s=c.isLoading,l=c.error,f=c.doFetch,p=function(){return s||l?s&&!l?r.a.createElement("div",null,"Loading..."):l?r.a.createElement("div",{style:{color:"red"}},l):null:null};return Object(a.useEffect)(function(){f(z(t.split(" ")[0]))},[t]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:Y.a.loadingOrError},r.a.createElement(p,null)),r.a.createElement("p",null,u[2]))},K=function(){var e=Object(U.a)(T.a.mark(function e(t){var n;return T.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onProgress,console.log("INFO: model has to be places in public folder to be accessible."),e.next=4,X.c("./assets/models/indoor-gps/model.json",{onProgress:n});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),Q=function(e){return X.e(function(){var t=X.a.fromPixels(e),n=X.b.resizeBilinear(t,[299,299]).toFloat(),a=X.d(255);return n.div(a).sub(X.d(.5)).mul(X.d(2)).expandDims(0)})},$=function(e){var t=e.videoRef,n=e.onPrediction,o=e.onProgress,c=Object(a.useState)(),u=Object(i.a)(c,2),s=u[0],l=u[1],f=Object(a.useState)(),p=Object(i.a)(f,2),m=p[0],d=p[1],v=Object(a.useState)(0),h=Object(i.a)(v,2),b=h[0],g=h[1],E=function(e){console.log(e),g(e),o&&o(e)};Object(a.useEffect)(function(){!function(){var e=Object(U.a)(T.a.mark(function e(){var t,n;return T.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K({onProgress:E});case 2:return t=e.sent,e.next=5,fetch("./assets/models/indoor-gps/class_names.txt").then(function(e){return e.text()}).then(function(e){return e.split(/\r\n|\n/).filter(function(e){return e.length>1})});case 5:n=e.sent,l(t),d(n);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()()},[]);var O=Object(a.useState)(!1),j=Object(i.a)(O,2),_=j[0],w=j[1],x=Object(a.useState)(500),y=Object(i.a)(x,2),S=y[0];y[1];!function(e,t){var n=Object(a.useRef)();Object(a.useEffect)(function(){n.current=e},[e]),Object(a.useEffect)(function(){if(null!==t){var e=setInterval(function(){n.current()},t);return function(){return clearInterval(e)}}},[t])}(function(){P()},_?S:null);var k=Object(a.useState)([]),C=Object(i.a)(k,2),D=(C[0],C[1]),N=Object(a.useState)(""),A=Object(i.a)(N,2),I=A[0],L=A[1],B=Object(a.useContext)(ge),P=function(){var e=Object(U.a)(T.a.mark(function e(){var a,r,o,c,i,u;return T.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t&&(a=t.current.video,(r=document.createElement("canvas")).width=1*a.videoWidth,r.height=1*a.videoHeight,r.getContext("2d").drawImage(a,0,0,r.width,r.height),o=Q(r),c=s.predict(o).dataSync(),(i=(i=(i=Object.values(c).map(function(e,t){return{index:t,value:e}})).sort(function(e,t){return e.value>t.value?1:e.value===t.value?0:-1})).reverse()).map(function(e){return M([e.index])[0]+" (".concat(e.index+1,")")}),u=i.map(function(e){return M([e.index])[0]}),console.log(i.slice(0,5)),D([u.slice(0,5)]),L(u[0]),n&&n(u[0]),B.setSearch(u[0]));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),M=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=m[e[n]];return t};return r.a.createElement("div",{style:{width:"100%"}},r.a.createElement("button",{style:{backgroundColor:_?"red":"lightgrey"},onClick:function(){return w(!_)}},"toggle detection"),r.a.createElement("br",null),1===b?"":"model loading: ".concat(100*b.toFixed(2),"%"),r.a.createElement("br",null),r.a.createElement("div",{style:{height:100,overflowY:"scroll"}},r.a.createElement(Z,{search:I})))},ee=n(28),te=n.n(ee),ne=function(e){var t=e.inputs,n=void 0===t?["button"]:t,a=e.onSubmit;if(1===n.length)return r.a.createElement("button",{className:te.a.button,key:n[0],onClick:a,value:n[0]},n[0]);var o=n.map(function(e,t){return 0===t?r.a.createElement("button",{className:te.a.buttonLeft,key:t,onClick:a,value:e},e):t===n.length-1?r.a.createElement("button",{className:te.a.buttonRight,key:t,onClick:a,value:e},e):r.a.createElement("button",{className:te.a.button,key:t,onClick:a,value:e},e)});return r.a.createElement("div",{className:te.a.buttonDiv},o)},ae=n(116),re=n(117),oe=n(123),ce=n(118),ie=n(124),ue=(n(269),n(271),n(119)),se=n.n(ue),le=function(e){function t(){var e,n;Object(ae.a)(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(oe.a)(this,(e=Object(ce.a)(t)).call.apply(e,[this].concat(o)))).ref=r.a.createRef(),n}return Object(ie.a)(t,e),Object(re.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("touchstart",this.touchStart),window.addEventListener("touchmove",this.preventTouch,{passive:!1})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("touchstart",this.touchStart),window.removeEventListener("touchmove",this.preventTouch,{passive:!1})}},{key:"touchStart",value:function(e){this.firstClientX=e.touches[0].clientX,this.firstClientY=e.touches[0].clientY}},{key:"preventTouch",value:function(e){this.clientX=e.touches[0].clientX-this.firstClientX,this.clientY=e.touches[0].clientY-this.firstClientY;try{if("react-slick"===e.touches[0].target.offsetParent.className&&Math.abs(this.clientX)>5)return e.preventDefault(),e.returnValue=!1,!1}catch(t){if(Math.abs(this.clientX)>5)return e.preventDefault(),e.returnValue=!1,!1}}},{key:"render",value:function(){return r.a.createElement(se.a,Object.assign({ref:this.ref},this.props.settings),this.props.children)}}]),t}(a.Component);le.defaultProps={minValue:5,settings:{}};var fe=function(){var e=Object(a.useContext)(ge),t={arrows:!1,infinite:!1,slidesToShow:3,slidesToScroll:3},n=e.closestList.lbls.length>0?e.closestList.lbls:[];return r.a.createElement("div",{className:C.a.exploreDiv},r.a.createElement("h3",null,"Welcome to the museum!"),r.a.createElement("h4",null,"What's Nearby "),r.a.createElement("small",null,"tap on the map to see what's nearby!"),r.a.createElement(le,{settings:t},n.map(function(e,t){return r.a.createElement("div",{key:t,className:C.a.carouselDiv},r.a.createElement("h5",null,e))})),r.a.createElement("h4",null,"Other Things to See"),r.a.createElement(le,{settings:t},e.dataset.map(function(e,t){return r.a.createElement("div",{key:t,className:C.a.carouselDiv},r.a.createElement("h5",null,e.label))})),r.a.createElement("h4",null,"About the museum"),r.a.createElement("h4",{style:{margin:0,padding:0}},"Opens 9am - 5pm"),r.a.createElement("small",null,r.a.createElement("p",null,"Established in 1877, the National Museum of Nature and Science boasts one of the richest histories of any museum in Japan. It is Japan's only nationally administered comprehensive science museum, and is a central institute for research in natural history and history of science and technology."," ",r.a.createElement("a",{href:"https://artsandculture.google.com/partner/national-museum-of-nature-and-science",target:"_blank",rel:"noopener noreferrer"},"more"))))},pe=function(){var e=Object(a.useState)(""),t=Object(i.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(),u=Object(i.a)(c,2),s=u[0],l=u[1];return Object(a.useEffect)(function(){console.log(s)},[s]),r.a.createElement("div",{className:C.a.discoverDiv},r.a.createElement(R,{onTakePhoto:function(e){console.log("ontake photo!"),console.log(e)},onRef:l}),r.a.createElement("br",null),r.a.createElement("p",null,"prediction: ",n),r.a.createElement($,{videoRef:s,onPrediction:o}))},me=function(e){var t=e.inputs,n=e.onSubmit;return r.a.createElement("div",{className:C.a.buttonDiv},r.a.createElement(ne,{inputs:t,onSubmit:n}))},de=function(){var e=Object(a.useState)("\ud83d\udcf7"),t=Object(i.a)(e,2),n=t[0],o=t[1],c=["explore \ud83d\udd0d","\ud83d\udcf7"];return n===c[0]?r.a.createElement(A,{onExit:function(){return o("main")},blurOnButtonOnly:!0},r.a.createElement(fe,null)):n===c[1]?r.a.createElement(A,{text:"discover",onExit:function(){return o("main")}},r.a.createElement(pe,null)):r.a.createElement(me,{inputs:c,onSubmit:function(e){return o(e.target.value)}})},ve=function(){return r.a.createElement("div",{className:C.a.main},r.a.createElement(de,null))},he=(n(288),n(120)),be=n.n(he),ge=r.a.createContext(),Ee=function(e){var t=function(e){var t=Object(a.useState)([]),n=Object(i.a)(t,2),r=n[0],o=n[1],c=function(e){Object(q.a)(e).then(function(e){o(e)})};Object(a.useEffect)(function(){e&&c(e)},[]);var u=Object(a.useState)(),s=Object(i.a)(u,2),l=s[0],f=s[1];return Object(a.useEffect)(function(){l&&c(l)},[l]),[r,f]}(be.a),n=Object(i.a)(t,2),o=n[0],c=(n[1],Object(a.useState)([972,1982])),u=Object(i.a)(c,2),l=u[0],f=u[1],p=Object(a.useState)({pins:[],lbls:[]}),m=Object(i.a)(p,2),d=m[0],v=m[1],h=Object(a.useState)(""),b=Object(i.a)(h,2),g=b[0],E=b[1],O=Object(a.useState)(""),j=Object(i.a)(O,2),_={point:l,setPoint:f,closestList:d,setClosestList:v,photo:g,setPhoto:E,label:"a dinosaur! RAWR",dataset:o,search:j[0],setSearch:j[1]};return r.a.createElement("div",{className:s.a.app},r.a.createElement(ge.Provider,{value:_},r.a.createElement(S,null,r.a.createElement(ve,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(Ee,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},36:function(e,t,n){},51:function(e,t,n){e.exports={card:"Card_card__1vPsL",buttonDiv:"Card_buttonDiv__37EMv",exitButton:"Card_exitButton__2TqB9"}},66:function(e,t,n){e.exports={main:"Map_main__QJyVg",map:"Map_map__1PYVP"}}},[[125,2,1]]]);
//# sourceMappingURL=main.f0a9ce8e.chunk.js.map